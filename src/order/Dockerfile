FROM python:3.11

ARG DATABASE_URL
ARG JWT_SECRET_KEY
ARG USER_SERVICE_URL
ARG PRODUCT_SERVICE_URL
ARG ORDER_SERVICE_PORT

ENV DATABASE_URL=${DATABASE_URL}
ENV JWT_SECRET_KEY=${JWT_SECRET_KEY}
ENV USER_SERVICE_URL=${USER_SERVICE_URL}
ENV PRODUCT_SERVICE_URL=${PRODUCT_SERVICE_URL}

WORKDIR /app

COPY requirements.txt /app/requirements.txt
RUN pip install --no-cache-dir -r requirements.txt

COPY . /app

EXPOSE ${ORDER_SERVICE_PORT}

ENTRYPOINT ["uvicorn"]
CMD ["app:app", "--host", "0.0.0.0", "--port", "${ORDER_SERVICE_PORT}"]
